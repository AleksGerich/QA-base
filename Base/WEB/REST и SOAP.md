---
tags:
  - REST
  - soap
---

---
#REST
# REST

**REST** (Representational state transfer) – архитектурный стиль взаимодействия компонентов распределённого приложения в сети

REST — это набор правил того, как программисту организовать написание кода серверного приложения, чтобы все системы легко обменивались данными и приложение можно было масштабировать

Для веб-служб, построенных с учётом REST (то есть не нарушающих накладываемых им ограничений), применяют термин «**RESTful**»
### Концепция
1. Архитектура в стиле REST состоит из клиентов и серверов. 
2. Клиенты инициируют запросы к серверам; 
3. Серверы обрабатывают запросы и возвращают подходящие ответы. 
4. Запросы и ответы создаются на базе передачи представлений ресурсов.

### Цели REST
- Масштабируемость взаимодействия компонентов
- Общность интерфейсов
- Независимое внедрение компонентов
- Промежуточные компоненты, снижающие задержку, усиливающие безопасность и инкапсулирующие устаревшие системы

### Методы REST

- **GET** - используется для получения (или чтения) представления ресурса.
	
- **PUT** - обычно используется для предоставления возможности обновления ресурса. Тело запроса при отправке PUT-запроса к существующему ресурсу URI должно содержать обновленные данные оригинального ресурса (полностью, или только обновляемую часть).
	
- **POST** - используется для создания новых ресурсов. На практике он используется для создания вложенных ресурсов. POST запрос отправляется к родительскому ресурсу и, таким образом, сервис берет на себя ответственность на установление связи создаваемого ресурса с родительским ресурсом, назначение новому ресурсу ID и т.п.
	
- **DELETE** - используется для удаления ресурса, идентифицированного конкретным URI (ID).

## Принципы REST

1. **Технология «клиент-сервер»**. Клиенты отделены от сервера единым интерфейсом. Это разделение ответственности означает, что клиенты не отвечают за хранилище данных - так что переносимость кода клиента улучшается. Серверы не отвечают за пользовательский интерфейс или пользовательское состояние - серверы могут быть проще и более масштабируемыми.
	
2.  **Отсутствие состояния**. Каждый запрос от клиента к серверу должен содержать всю необходимую информацию для его обработки. Сервер не хранит никаких данных о состоянии клиента между запросами, что упрощает масштабирование и поддержку.
	
3. **Кэшируемость**. клиенты могут кэшировать ответы. Поэтому ответы должны, явно или неявно, определять себя кэшируемыми или нет, чтобы предотвратить использование клиентом старые или неподходящие данные при ответе на следующие запросы.
	
4. **Многоуровневая система**. Клиент не может однозначно определить, подключается ли он непосредственно к серверу или к посреднику по пути подключения.
	
5. **Код по требованию (опционально)**. Серверы могут временно расширить или настроить функциональность клиента, передавая ему исполняемую логику.
	
6. **Единый интерфейс**. REST требует стандартного, согласованного интерфейса Единый интерфейс между клиентами и серверами, упрощает и разделяет архитектуру, позволяя каждой части развиваться самостоятельно.
	
	- *Идентификация ресурсов*: Каждый ресурс имеет уникальный URL.
	- *Манипуляция ресурсом через представление*: Сервер предоставляет клиенту необходимую информацию о взаимодействии с ресурсом.
	- *Самоописывающие сообщения*: Запросы содержат всю необходимую информацию для понимания.
	- *Гипермедиа как движущая сила приложения (HATEOAS)*: Ответы могут содержать ссылки, которые показывают клиенту возможные дальнейшие действия.
	
7. **Начало от нуля (Starting with the Null Style)**. Клиент знает только одну точку входа на сервер. Дальнейшие возможности по взаимодействию обеспечиваются сервером.

---
#### Преимущества

- **Надёжность** (за счёт отсутствия необходимости сохранять информацию о состоянии клиента, которая может быть утеряна);
	
- **Производительность** (за счёт использования кэша);
	
- **Масштабируемость**;
	
- **Прозрачность системы взаимодействия** (особенно необходимая для приложений обслуживания сети);
	
- **Простота интерфейсов**;
	
- **Портативность компонентов**;
	
- **Лёгкость внесения изменений**;

#### Форматы данных:
- JSON
- HTML
- XML
- TXT

## Около-примеры

API-интерфейсы управления. API, ориентированные на управление объектами в системе и предназначенные для многих потребителей, распространены шире всего. REST помогает таким API, обеспечивая сильную обнаруживаемость и хорошую документацию, и тем самым вписывается в эту объектную модель.

Простые приложения, управляемые ресурсами. REST  —  это валидный подход для подключения приложений, управляемых ресурсами, которые не нуждаются в гибкости запросов

[Инфа по REST из базы знаний](https://confluence.senlainc.com/display/KB/REST)

---
#soap
# SOAP

**SOAP** (Simple Object Access Protocol до версии 1.2) - протокол обмена структурированными сообщениями в распределённой вычислительной среде. 

Первоначально SOAP предназначался в основном для реализации удалённого вызова процедур (RPC). Сейчас протокол используется для обмена произвольными сообщениями в формате XML, а не только для вызова процедур. 

*Нюансы:*
- более "тяжеловесный" в плане обработки данных в сравнении с REST
- SOAP работает только с XML форматом 
- REST прощее и быстрее SOAP

Официальная спецификация последней версии 1.2 протокола никак не расшифровывает название SOAP. SOAP является расширением протокола XML-RPC.

SOAP может использоваться с любым протоколом прикладного уровня: SMTP, FTP, HTTP, HTTPS и др. Однако его взаимодействие с каждым из этих протоколов имеет свои особенности, которые должны быть определены отдельно. 

Чаще всего SOAP используется поверх HTTP.

Протокол начинает свою работу с файла WSDL (характерная черта - добавление ?WSDL вконце url)

WSDL описывает все операции, которые умеет выполнять сервис в виде XML (документация всего сервиса)

В приложении SOAP UI, при открытии проекта, в нем появляются две версии SOAP: обычная и версия 1.2 

**Отступление про пространство имен:**
- по сути, аналог полиморфизма. Для объектов xml файла с одинаковым именем вводится собственный идентификатор
- так же служит для разграничения таблиц, для обращения к определенной
- имя пространства принято писать через url
*@:*
<h:TEMP xmlns:h="http://www.example.com/temp">
  <h:tr>
    ...
  </h:tr>
</h:TEMP>

---
## Использование метаданных в SOAP

SOAP — это протокол для обмена структурированными сообщениями в веб-сервисах, и метаданные играют ключевую роль для передачи информации, необходимой для правильной обработки сообщения, таких как аутентификация, сессии, трассировка и другое.

Метаданные (в общем) - данные о данных. Описывают структуру, содержание, контекст или другие важные характеристики информации. 

**В контексте SOAP метаданные** - информация, передающаяся вместе с сообщением для маршрутизации и интерпретации. Содержится зачастую в заголовке (\<header>) и частично в теле (<body\>)

Хотя XML-теги описывают структуру SOAP-сообщения, **не все они являются метаданными**, поскольку большинство из них служат для форматирования и передачи фактического содержания сообщения.

### Заголовки (header)

**Header** - секция в SOAP-сообщении, где хранятся метаданные. Не является обязательной.

Содержит информацию о маршрутизации, аутентификации и других настройках, необходимых для интерпретации и маршрутизации сообщения.

*@:*
- идентификаторы сессии
- токены аутентификации
- параметры безопасности
- другие контекстные данные, которые не относятся к основному содержанию (body) сообщения

### Атрибуты

SOAP-сообщения используют XML-формат, и атрибуты XML в теле и заголовках сообщения также могут содержать метаданные. 

**Определяют**:
- параметры вызова
- типы данных
- дополнительные параметры (@: валидация типов)

### WSDL

Описание метаданных о самом веб-сервисе хранится в формате **WSDL** (Web Services Description Language). Хотя WSDL не передается вместе с SOAP-сообщением, оно описывает доступные методы, ожидаемые параметры и типы ответов, что можно считать метаданными о сервисе.
#### WSDL описывает:
- информация о структурах сообщений
- типах данных 
- форматы операций

[Ответы по вопросам Web-сервисов](https://jsehelper.blogspot.com/2016/04/web-services.html)

## Послесловие

В настоящее время архитектура SOAP чаще всего применяется для интеграции внутри предприятий или с их доверенными партнерами.

Надежность передачи данных. Жесткая структура SOAP, а также возможности в плане безопасности и авторизации, делают его наиболее подходящим вариантом для обеспечения соответствия формальному программному контракту между API и клиентом при соблюдении юридического контракта между поставщиком API и потребителем API. Вот почему финансовые организации и другие корпоративные пользователи выбирают SOAP.

---
#xml #wsdl #xsd
# XML, WSDL, XSD

**XML**, в переводе с англ eXtensible Markup Language — расширяемый язык разметки. Используется для хранения и передачи данных. Так что увидеть его можно не только в API, но и в коде. Этот формат рекомендован Консорциумом Всемирной паутины (W3C), поэтому он часто используется для передачи данных по API.

**XSD** — это язык описания структуры XML документа. Его также называют XML Schema. При использовании XML Schema XML парсер может проверить не только правильность синтаксиса XML документа, но также его структуру, модель содержания и типы данных. (Схема в документе WSDL). на основе XSD строится схема в SOAP UI 

**WSDL** расшифровывается как язык описания веб-сервисов. Это стандартный формат для описания веб-службы. WSDL был разработан совместно Microsoft и IBM.

XML: расширяемый язык разметки.
XSD: определение схемы XML.
WSDL: язык определения веб-сервисов.

---
#различия_SOAP_REST
# Сравнение REST и SOAP

## Различия
#### Принципиальное:
- REST - архитектурный подход для создания ПО
- SOAP - протокол передачи данных в формате XML

#### Различия между REST и SOAP Веб-сервисами

- REST поддерживает различные форматы: text, JSON, XML; SOAP - только XML,
	
- REST работает только по HTTP(S), а SOAP может работать с различными протоколами
	
- SOAP на основе чтения не может быть помещена в кэш, а REST в этом случае может быть закэширован
	
- SOAP поддерживает SSL и WS-security, в то время как REST - только SSL,
	
- SOAP поддерживает ACID (Atomicity, Consistency, Isolation, Durability). REST поддерживает транзакции, но не один из ACID не совместим с двух фазовым коммитом.

## Сравнение

#### Плюсы SOAP
- **Независимость от языка и платформы.** Встроенная функциональность для создания веб-сервисов позволяет SOAP обрабатывать сообщения и делать ответы независимыми от языка и платформы
	
- **Связанность с различными транспортными протоколами.** SOAP гибок с точки зрения протоколов передачи и приспосабливается к более чем одному сценарию (когда REST - только HTTP)
	
- **Встроенная обработка ошибок.** Спецификация SOAP API позволяет возвращать XML-сообщение Retry с кодом ошибки и ее объяснением
	
- **Ряд расширений безопасности.** Благодаря интеграции с протоколами WS-Security качество транзакций SOAP соответствует корпоративным стандартам. SOAP гарантирует конфиденциальность и целостность внутри транзакций, обеспечивая при этом шифрование на уровне сообщений

#### Минусы SOAP
- **Только XML.** SOAP-сообщения содержат много метаданных и поддерживают только подробные XML-структуры для запросов и ответов
	
- **Тяжеловесность**. Из-за большого размера XML-файлов SOAP-сервисы требуют большой пропускной способности
	
- **Узкоспециализированные знания.** Создание серверов SOAP API требует глубокого понимания всех задействованных протоколов и их строгих правил
	
- **Утомительное обновление сообщений.** Требуются дополнительные усилия для добавления или удаления свойств сообщения  —  жесткая схема SOAP замедляет принятие

SOAP  —  это хлопотно, но его обширный функционал в плане безопасности по-прежнему незаменим для биллинговых операций, систем бронирования и платежей.


#### Плюсы REST
- **Разделение клиента и сервера**. По возможности разделяя клиент и сервер, REST обеспечивает лучшую абстракцию по сравнению с RPC. Система с уровнями абстракции способна инкапсулировать свои детали, чтобы лучше идентифицировать и поддерживать свои свойства. Поэтому REST API достаточно гибок, чтобы развиваться с течением времени и при этом оставаться стабильной системой
	
- **Открытость**. Все описывается связью между клиентом и сервером, так что для понимания, как взаимодействовать с REST API, не требуется никакая внешняя документация
	
- **Дружественность к кэшу**. REST  —  единственный стиль, который позволяет кэшировать данные на уровне HTTP благодаря повторному использованию множества HTTP-инструментов. В то же время, реализация кэширования в любом другом API потребует настройки дополнительного модуля кэширования
	
- **Поддержка нескольких форматов.** Возможность поддержки нескольких форматов хранения и обмена данными  —  одна из причин, по которым REST в настоящее время преобладает в сфере создания общедоступных API

#### Минусы REST
- **Нет единой структуры REST**. Нет точного правильного способа создания REST API. Как моделировать ресурсы и какие ресурсы моделировать, будет зависеть от каждого сценария. Это делает REST простым в теории, но трудным на практике
	
- **Большие полезные нагрузки**. REST возвращает много богатых метаданных, так что клиент может понять все необходимое о состоянии приложения только из его ответов. И эта болтливость не имеет большого значения для большой сетевой трубы с большой пропускной способностью. Но это не всегда так. Это стало ключевым движущим фактором для Facebook, придумавшего описание стиля GraphQL в 2012 году
	
- **Проблемы чрезмерных или недостаточных данных**. Ответы REST зачастую содержат либо слишком много данных, либо их недостаточное количество, и создают необходимость в дополнительном запросе

REST обладает самой высокой абстракцией и лучшим моделированием API. Но он, как правило, тяжелее в плане нагрузки на сеть и многословнее  —  недостаток, если вы работаете на мобильных устройствах.

[Сурс (с VPN)](https://nuancesprog.ru/p/11310/)

---
#RPC 
# Протокол RPC

Удаленный вызов процедур (RPC) – это метод межпроцессного взаимодействия. Используется для клиент-серверных приложений. 

Механизмы RPC используются, когда компьютерная программа вызывает выполнение процедуры или подпрограммы в другом адресном пространстве, которое закодировано как обычный вызов процедуры, при этом программист специально не кодирует детали для удаленного взаимодействия. Этот вызов процедуры также управляет транспортным протоколом низкого уровня, таким как протокол пользовательских дейтаграмм, протокол управления передачей / Интернет-протокол и т.д. 

Он используется для передачи данных сообщения между программами. 

Самый большой недостаток метода RPC заключается в том, что он очень уязвим к сбоям, поскольку в нем задействованы система связи, другая машина и другой процесс.

[Материал с CoderLessons (с VPN)](https://coderlessons.com/tutorials/akademicheskii/osnovy-operatsionnykh-sistem/13-udalennyi-vyzov-protsedur-rpc)

RPC — подходящий выбор для отправки команд в удаленную систему. Например, Slack API очень командно-ориентирован: зайти на канал, покинуть канал, отправить сообщение. Разработчики Slack API как раз и смоделировали его в стиле RPC, сделав его маленьким, компактным и простым в использовании.

---
# Сравнение протоколов

![[Pasted image 20241112165450.png]]

|                              |                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                 |                                                                                                                                                                                              |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **API Architectural Styles** |                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                 |                                                                                                                                                                                              |
|                              | **RPC**                                                                                                                                                                                                                                                                               | **SOAP**                                                                                                                                                                                                                                                           | **REST**                                                                                                                                                                                                                                        | **GraphQL**                                                                                                                                                                                  |
| **Формат**                   | JSON, XML, Protobuf, Thrift, FlatBuffers                                                                                                                                                                                                                                              | XML                                                                                                                                                                                                                                                                | XML, JSON, HTML, plain text                                                                                                                                                                                                                     | JSON                                                                                                                                                                                         |
| **Обучаемость**              | Легко                                                                                                                                                                                                                                                                                 | Сложно                                                                                                                                                                                                                                                             | Легко                                                                                                                                                                                                                                           | Средне                                                                                                                                                                                       |
| **Сообщество**               | Большое                                                                                                                                                                                                                                                                               | Маленькое                                                                                                                                                                                                                                                          | Большое                                                                                                                                                                                                                                         | Растущее                                                                                                                                                                                     |
| **Где применяется**          | командный и ориентированный на действия API; внутренняя высокопроизводительная коммуникация в массивных системах микросервисов  <br>Благодаря своей сильной связанности RPC хорошо годится для внутренних микросервисов, но это не вариант для сильного внешнего API или API-сервиса. | платежные системы, CRM-решения для управления идентификацией, финансовые и телекоммуникационные сервисы,  <br>SOAP — это хлопотно, но его обширный функционал в плане безопасности по-прежнему незаменим для биллинговых операций, систем бронирования и платежей. | простые приложения с открытым API  <br>  <br>REST обладает самой высокой абстракцией и лучшим моделированием API. Но он, как правило, тяжелее в плане нагрузки на сеть и многословнее — недостаток, если вы работаете на мобильных устройствах. | Мобильные API, сложные системы, микро-сервисы  <br>  <br>GraphQL — большой шаг вперед с точки зрения извлечения данных, но не у всех достаточно времени и возможностей, чтобы его осваивать. |


---


