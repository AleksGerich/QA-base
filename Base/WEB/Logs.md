
**Лог** (журнал событий) - файл с записями о событиях, происходящих в системе

**Логирование** - процесс формирования логов, то есть фиксация и структурирование информации о работе системы в отдельные лог-файлы, чтобы можно быстро получить к ним доступ

#### Общая структура логов
- **системная информация** (время и дата события, ID события, метод, версия HTTP, код...)
- **уровень лога**
- **текст сообщения** (@: сообщение об ошибке)
- **контекст** (доп. информация)

*Пример лога об ошибке*
![](Pasted%20image%2020241203174643.png)

В примере также присутствует стек вызовов - информация о классах и методах, в которых произошла ошибка

## Уровни логов

Уровни логов - описывает насколько важная информация будет выводится в лог-файле

#### TRACE 
- Пошаговые записи процессов, для поиска ошибок на каждом шаге
- *@:* значения переменных, шаги выполнения алгоритма и т.д.
#### DEBUG
- Запись масштабных переходов состояний (обращение к БД, старт или пауза сервиса)
- Позволяет выявлять ошибки в программном коде
#### INFO
- информационные сообщения о том, что происходит в приложении
- запись основной информации
- часто используется для мониторинга работы приложения в проде
#### WARNING
- Предупреждения о возникновении нежелательной ситуаци
- *@:* данные некорректны, но приложение продолжает работать
#### ERROR
- Ошибки, при которых приложение способно продолжить работать
#### FATAL
- Фатальные ошибки, обычно приводящие к завершению работы приложения
#### OFF 
- логирование выключено

Более низкие уровни логов всегда включают в себя логи высокого уровня
*@:* **DEBUG** включает в себя **INFO**, **WARNING**, **ERROR**

## Виды логов

1. ***Логи приложения***
	
2. ***Логи сервера*** - логи от серверов или веб-серверов
	- Error Logs - информация об ошибках    
	- Access Logs - информация о запросах и ответах сервера
	
3. ***Системные логи*** - логи от ОС

##### Также могут быть и другие виды:

![](Pasted%20image%2020241204103025.png)

## Команды для работы с логами сервера

### cat 
- конкатенация, используется для вывода содержимого файлов на экран терминала
#### cat file.txt
- Вывод содержимоо файлов на экран

#### cat file1.txt file2.txt
- Объединение содержимого файлов для вывода

#### cat *
- Вывод всех файлов в директории

#### cat \*.js
- Вывод всех файлов в директории с расширением .js (или любой другой паттерн)

#### cat -n file1.txt
- нумерация строк при выводе файла

---
### head
- для просмотра первых строк файла
#### head -30 file.txt
- выводит первые 30 строк файла

### tail
- для просмотра последних строк файла
#### tail -30 file.txt
- выводит последние 30 строк файла
#### tail -f file.txt
- просмотр логов в реальном времени (наиболее часто используется)

---
### diff
- построчное сравнение двух файлов 
- после анализа, выводятся строки, которые не совпадают

#### diff file1.txt file2.txt

---
### find
- используется для поиска файлов и директорий по заданным шаблонам

#### find ./ -name "file"
- поиск по имени "file" в текущей директории

#### find /abs/path/dir -name "\*.js"
- поиск в указанной директории всех файлов с расширением js

--- 
### grep [паттерн]  [имя файла]
- вывести из файла строки, содержащие паттерн
- *паттерн* - исходный текст
- *имя файла* - файл для поиска

*@:* **grep utf-8 ispmgr.sh**

#### Дополнительные параметры:
- **-A \<N>** - вывод N строк после совпадения 
	- *@:* grep utf-8 ispmgr.sh -A 5
- **-B \<N>** - вывод N строк начала файла ДО совпадения
- **-C \<N>** - вывод N строк До совпадения и ПОСЛЕ совпадения
- **-i** - совпадение независимо от регистра 
	- *@:* grep -i utf-8 file.txt
- **-R** - рекурсивный поиск в директории 
	- *@:* grep -R utf-8 /etc

---
### Сочетание команд

#### find / | grep [часть в названии файла]
- выведет все имеющиеся файлы в которых будет присутствовать указанная часть в названии

*@:*
**find / | grep viruside**

![](Pasted%20image%2020241204115553.png)

---
## Инструменты для анализа логов 

#### Notepad++
- наличие встроенных стилей позволяют фильтровать информацию лога (раздел Синтаксис)
- можно задать свой синтаксис
- Можно задать подсветку ключевых слов (по типу INFO, ERROR, FATAL...) (во вкладке Ключевые слова)
- Можно разделять по строкам (Вид -> Перенос строк)
- Есть встроенный поиск

#### Araxis Merge
- позволяет сравнивать текстовые файлы в режиме линия - линия, символ-символ
- параллельное сравнение
- нет проблем с кодировками
- генерация отчетов по результатам сравнения